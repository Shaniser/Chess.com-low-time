console.log("Foreground Script with Dynamic Ticking and Turn Check");

let tickSound = new Audio("data:audio/mp3;base64,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XGstxloLAEBocAAAO7BhdYSTorHAQkNWAgB5AACQUkoxxhhjTCmlGGOMMaaUUowxxphTSinGGGPMOacUY4wx5pxjjDHGGHPOMcYYY4w55xhjjDHGnHPOMcYYY8455xhjjDHnnHOMMcaYAACgAgcAgAAbRTYnGAkqNGQlABAOAAAYw5RzzkEoJZUKIcYgdFBKSq1VCDEGIYRSUmotas45CCGUklJr0XPOQQihlJRai6qFUEopJaXWWnQtdFJKSam1GKOUIoSQUkqttRidEyGEklJqLcbmnIylpNRajDE252QsJaXWYoyxOeeca621FmOtzTnnXGspthhrbc45p3tsMdZYa3POOZ9bi63GWgsAMHlwAIBKsHGGlaSzwtHgQkNWAgC5AQCMUowx5pxzzjnnnHPOSaUYc845CCGEEEIIIZRKMeaccxBCCCGEEEIoGXPOOQchhBBCCCGEUErpnHMQQgghhBBCCKGU0jnnIIQQQgghhBBCKaVzzkEIIYQQQgghhFJKCCGEEEIIIYQQQgillFJCCCGEEEIIIYQQSimlhBBCCCGEEEIIIZRSSgkhhBBCCCGEEEIopZQSQgghhBBCCCWEUEoppZQQQgihhBBCCKGUUkopIYRSSikhhBBCKaWUUkIooYQQQgghlFJKKaWUEkIpIYQQQgillFJKKaWUUkIIIYQQSimllFJKKaWEUEIIIZRSSimllFJCKCWEEkIopZRSSimlhFBCCCGEUEoppZRSSgkhhBJCCKEAAKADBwCAACMqLcROM648AkcUMkxAhYasBADSAgAAQ6y11lprrbXWWmsNUtZaa6211lprrbVGKWuttdZaa6211lprqbXWWmuttdZaa6211lprrbXWWmuttdZaa6211lprrbXWWmuttdZaa6211lprrbXWWmuttdZaa6211lprrbXWWmuttdZaa6211lprrbXWWmuttdZaa6211lprrbXWWmuttdZaa6211lprrbXWWmuttdZaa6211lprrbXWWmuttdZaSymllFJKKaWUUkoppZRSSimllFJKKaWUUkoppZRSSimllFJKKaWUUkoppZRSSimllFJKKaWUUkoppZRSAdgFGw6A0RNGElJnGVYaceMJGCKQQkNWAgBpAQCAMYwx5hh0EEpJKaUKIecghE5CKq3FFmOEkHMQQiglpdZiizF4DkIIIZTSUmwx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"); // Short ticking sound
tickSound.volume = 0.1; // Set the volume once
let tickingInterval = null; // Variable to store the setInterval identifier
const syncTickingInterval = 200; // Synchronization interval (ms)
let lastSecondsLeft = null; // Last known remaining time (seconds)
let lastIsMyTurn = null; // Last known turn status
let staticSecondsCounter = 0; // Counter for static time
let speedLevel = -1;

/**
 * Check if it's the player's turn
 * @param {Element} clockElement - The timer element
 * @returns {boolean} - True if it is the player's turn
 */
function isItMyTurn(clockElement) {
    return clockElement && clockElement.classList.contains("clock-player-turn");
}

/**
 * Play the ticking sound
 */
function playTickSound() {
    tickSound.currentTime = 0; // Reset sound playback
    tickSound.play(); // Play the sound
}

/**
 * Stop the ticking sound
 */
function stopTicking() {
    if (tickingInterval) {
        clearInterval(tickingInterval); // Clear the ticking interval
        tickingInterval = null;
    }
}

/**
 * Main function to synchronize the timer and turn status
 */
async function syncTicking() {
    try {
        // Locate the timer element
        const myClock = document
            .getElementById("board-layout-player-bottom")
            ?.getElementsByClassName("clock-component")[0];
        if (!myClock) {
            stopTicking();
            return; // Exit if the timer element is not found
        }

        const remain = myClock.querySelector("span")?.innerHTML;
        if (!remain) {
            stopTicking();
            return; // Exit if the timer value is not found
        }

        // Parse the remaining time (minutes and seconds)
        const [completeMinLeft, secondsLeft] = remain.split(":").map(Number);

        // Check if it's currently the player's turn
        const myTurn = isItMyTurn(myClock);

        if (myTurn) {
            // If less than a minute is left, adjust ticking speed
            if (completeMinLeft === 0) {
                const newSpeedLevel = Math.floor(secondsLeft / 10);

                // Play the sound immediately if the turn has just changed
                if (lastIsMyTurn !== myTurn || speedLevel !== newSpeedLevel) {
                    playTickSound();
                }

                // Calculate the interval for ticking, minimum is 100 ms
                const interval = Math.max(100, (secondsLeft * 1000) / 60);
                if (!tickingInterval || speedLevel !== newSpeedLevel) {
                    clearInterval(tickingInterval); // Reset the previous interval
                    tickingInterval = setInterval(playTickSound, interval);
                    speedLevel = newSpeedLevel;
                }
            }
        } else {
            // Stop ticking if it's not the player's turn
            stopTicking();
        }

        // Check if the time or turn status has changed
        if (lastSecondsLeft === secondsLeft && lastIsMyTurn === myTurn) {
            staticSecondsCounter++;
            if (staticSecondsCounter * syncTickingInterval > 1000) {
                // Stop the sound if the time hasn't changed for over 1 second
                stopTicking();
            }
        } else {
            staticSecondsCounter = 0; // Reset the static time counter
        }

        // Update the last known time and turn status
        lastSecondsLeft = secondsLeft;
        lastIsMyTurn = myTurn;
    } catch (error) {
        console.error("Error syncing ticking:", error);
    }
}

/**
 * Initialize the ticking synchronization process
 */
setInterval(syncTicking, syncTickingInterval); // Check the state every 200 ms
